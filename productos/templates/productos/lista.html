<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>ElecTRON - Tienda de Electr√≥nica</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'productos/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
</head>
<body>
    

<header>
    <div class="topbar">
        <div class="brand">
            <div class="badge">üíª</div>
            <div>ElecTRON - Lo Mejor en Electr√≥nica</div>
        </div>
        <button id="themeToggle">‚òÄÔ∏è / üåô</button>
        <div class="spacer"></div>

{% if user.is_authenticated %}
  <a href="{% url 'profile' %}" class="pill">
    {% if user.profile.avatar %}
      <img src="{{ user.profile.avatar.url }}" alt="avatar"
           style="width:24px;height:24px;border-radius:50%;object-fit:cover;vertical-align:middle;margin-right:6px">
    {% else %}
      <i class="fa-regular fa-user" style="margin-right:6px"></i>
    {% endif %}
    {{ user.first_name|default:user.username }}
  </a>
{% else %}
  <a href="{% url 'login' %}" class="pill">Iniciar sesi√≥n</a>
  <a href="{% url 'signup' %}" class="pill eco">Registrarse</a>
{% endif %}


        <button id="btnCart" class="pill eco">üõí Carrito <span id="cartCount" class="cart-count">0</span></button>
    </div>

    <form class="toolbar" method="get" action=".">
        <button type="submit" class="btn eco">Buscar</button>
        <div class="control">
            <input type="search" name="q" id="q" placeholder="Buscar (modelo, etiqueta, uso)" value="{{ request.GET.q }}">
        </div>
        <div class="control">
            <input type="number" name="min" id="min" placeholder="Precio m√≠n (GTQ)" value="{{ request.GET.min }}">
            <input type="number" name="max" id="max" placeholder="Precio m√°x (GTQ)" value="{{ request.GET.max }}">
        </div>

        <div class="control">
            <select name="sort" id="sort">
                <option value="pop" {% if request.GET.sort == "pop" %}selected{% endif %}>Ordenar: Popularidad</option>
                <option value="priceAsc" {% if request.GET.sort == "priceAsc" %}selected{% endif %}>Precio ‚Üì</option>
                <option value="priceDesc" {% if request.GET.sort == "priceDesc" %}selected{% endif %}>Precio ‚Üë</option>
            </select>

            <div class="checks">
                <label class="small">
                    <input type="checkbox" name="nuevo" id="nuevo" {% if request.GET.nuevo %}checked{% endif %}> Nuevos
                </label>
                <label class="small">
                    <input type="checkbox" name="usado" id="usado" {% if request.GET.usado %}checked{% endif %}> Usados
                </label>
            </div>
        </div>

        <div class="control">
            <button type="submit" class="btn eco">Filtrar</button>
            <button type="button" id="limpiarF" class="pill">Eliminar filtrado</button>
        </div>
    </form>
</header>
<div class="carousel">
    <div class="carousel-track">
        {% for img in carousel_images %}
        <div class="carousel-slide {% if forloop.first %}active{% endif %}">
            {% if img.enlace %}
                <a href="{{ img.enlace }}">
                    <img src="{{ img.imagen.url }}" alt="{{ img.titulo }}">
                </a>
            {% else %}
                <img src="{{ img.imagen.url }}" alt="{{ img.titulo }}">
            {% endif %}
        </div>
        {% endfor %}
    </div>
    <button class="carousel-button prev">‚Äπ</button>
    <button class="carousel-button next">‚Ä∫</button>
</div>

<section class="promo-strip">
  {% for pill in promo_pills %}
    <a href="{{ pill.enlace|default:'#' }}"
       class="promo-pill{% if pill.variante == 'soft' %} soft{% endif %}">
      <div class="promo-pill__label">
        {{ pill.label_html|safe }}
      </div>
      <span class="promo-pill__cta">{{ pill.cta_text }}</span>
    </a>
  {% empty %}
    <a href="#" class="promo-pill">
      <div class="promo-pill__label"><strong>iPhone 17 PRO</strong> PREVENTA</div>
      <span class="promo-pill__cta">Ver aqu√≠</span>
    </a>
  {% endfor %}
</section>

<section class="promo-grid" aria-label="Promociones destacadas">
  {% if promo_cards %}
    {% for c in promo_cards %}
      <article class="promo-card {% if c.texto_claro %}promo-light{% endif %}">
        <div class="promo-bg
            {% if not c.imagen and c.gradiente_clase %}{{ c.gradiente_clase }}{% endif %}"
     {% if c.imagen %}style="background-image:url('{{ c.imagen.url }}');"{% endif %}>
</div>
        <div class="promo-content {% if c.texto_claro %}promo-light{% endif %}">
          <div>
            {% if c.badge_text %}
              <span class="promo-badge {% if c.badge_style == 'ghost' %}ghost{% endif %}">
                {{ c.badge_text }}
              </span>
            {% endif %}
            <h3 class="promo-title">{{ c.titulo }}</h3>
          </div>
          {% if c.enlace %}
            <a class="promo-btn" href="{{ c.enlace }}">{{ c.cta_text }}</a>
          {% else %}
            <button class="promo-btn" data-scroll="#grid">{{ c.cta_text }}</button>
          {% endif %}
        </div>
      </article>
    {% endfor %}
  {% else %}
    {# Fallback: si no has creado promos en admin, mostramos tus 6 tarjetas de ejemplo #}
  {% endif %}
</section>

<section class="featured">
  <div class="featured__head">
    <h2 class="featured__title">Productos destacados</h2>
    <a href="{% url 'productos_todos' %}" class="btn eco">Ver todos</a>
  </div>

  <div class="featured__rail">
    <button class="rail-btn prev" aria-label="Anterior">‚Äπ</button>

    <div class="rail" id="rail-ofertas">
      {% for p in productos|slice:":12" %}
     <article class="mini-card">
  <a class="mini-card__img" href="#">
    <img src="{{ p.imagen.url }}" alt="{{ p.nombre }}">
    {% if p.precio_original %}
      <span class="mini-card__badge">-%DESC%</span>
    {% endif %}
  </a>

  <div class="mini-card__body">
    <div class="mini-card__brand">
      Marca: <a href="?brand={{ p.marca|urlencode }}">{{ p.marca }}</a>
    </div>

    <a class="mini-card__name name" href="#">{{ p.nombre }}</a>

    <div class="mini-card__price">
      <strong class="price">Q{{ p.precio }}</strong>
      {% if p.precio_original %}
        <span class="str">Q{{ p.precio_original }}</span>
      {% endif %}
    </div>

    <button
  class="btn eco"
  data-add="{{ p.id }}"
  data-name="{{ p.nombre|escapejs }}"
  data-price="{{ p.precio }}"
>
  A√±adir al carrito
</button>

</article>

      {% endfor %}
    </div>

    <button class="rail-btn next" aria-label="Siguiente">‚Ä∫</button>
  </div>
</section>
<section class="featured">
  <div class="featured__head">
    <h2 class="featured__title">üéÆ Vive la experiencia gamer</h2>
    <a href="{% url 'productos_todos' %}?type=Consola" class="btn eco">Ver todos</a>
  </div>

  <div class="featured__rail">
    <button class="rail-btn prev" aria-label="Anterior">‚Äπ</button>

    <div class="rail" id="rail-gamer">
      {% for p in gamer_products %}
      <article class="mini-card">
        <a class="mini-card__img" href="#">
          <img src="{{ p.imagen.url }}" alt="{{ p.nombre }}">
          {% comment %} Badge de descuento {% endcomment %}
          {% if p.precio_original %}
            <span class="mini-card__badge"
                  data-old="{{ p.precio_original }}"
                  data-new="{{ p.precio }}">-%</span>
          {% endif %}
        </a>

        <div class="mini-card__body">
          <div class="mini-card__brand">
            Marca: <a href="?brand={{ p.marca|urlencode }}">{{ p.marca }}</a>
          </div>

          <a class="mini-card__name name" href="#">{{ p.nombre }}</a>

          <div class="mini-card__price">
            <strong class="price">Q{{ p.precio }}</strong>
            {% if p.precio_original %}
              <span class="str">Q{{ p.precio_original }}</span>
            {% endif %}
          </div>

          <button
  class="btn eco"
  data-add="{{ p.id }}"
  data-name="{{ p.nombre|escapejs }}"
  data-price="{{ p.precio }}"
>
  A√±adir al carrito
</button>

        </div>
      </article>
      {% empty %}
        <p>Sin productos gamer por ahora.</p>
      {% endfor %}
    </div>

    <button class="rail-btn next" aria-label="Siguiente">‚Ä∫</button>
  </div>
</section>


<aside id="drawer" class="drawer" aria-hidden="true">
  <header style="display:flex;align-items:center;justify-content:space-between;padding:12px;">
    <strong>Tu carrito</strong>
    <button id="closeCart" class="pill">‚úï</button>
  </header>

  <div style="padding:12px;flex:1;overflow:auto;">
    <div id="cartItems"></div>
  </div>

  <footer style="padding:12px;">
    <div class="line"><span>Subtotal</span><span id="subtotal">Q0.00</span></div>
    <div class="line"><span>IVA (12%)</span><span id="iva">Q0.00</span></div>
    <div class="line"><strong>Total</strong><strong id="total">Q0.00</strong></div>
    <div style="margin-top:10px;display:flex;gap:8px;">
      <button id="clearCart" class="btn ghost" style="flex:1;">Vaciar</button>
      <button class="btn eco" style="flex:1;">Pagar</button>
    </div>
  </footer>
</aside>
<div id="overlay" class="overlay" role="dialog" aria-modal="true" aria-hidden="true"></div>

<section class="usps">
  <div class="usps__grid">
    <article class="usps__item">
      <div class="usps__icon"><i class="fa-solid fa-shield-halved"></i></div>
      <div class="usps__body">
        <strong class="usps__title">Compra 100% segura</strong>
        <div class="usps__desc">Con encriptaci√≥n SSL</div>
      </div>
    </article>

    <article class="usps__item">
      <div class="usps__icon"><i class="fa-solid fa-headset"></i></div>
      <div class="usps__body">
        <strong class="usps__title">¬øNecesitas asistencia?</strong>
        <div class="usps__desc">Cont√°ctanos al 5986-1872</div>
      </div>
    </article>

    <article class="usps__item">
      <div class="usps__icon"><i class="fa-solid fa-rotate-left"></i></div>
      <div class="usps__body">
        <strong class="usps__title">Devoluci√≥n o reembolso</strong>
        <div class="usps__desc">Hasta 15 d√≠as</div>
      </div>
    </article>

    <article class="usps__item">
      <div class="usps__icon"><i class="fa-solid fa-truck-fast"></i></div>
      <div class="usps__body">
        <strong class="usps__title">Env√≠os en 48 horas</strong>
        <div class="usps__desc">Gratis recoger en tienda</div>
      </div>
    </article>
  </div>
</section>

<footer class="footer">
  <div class="footer-container">
    <div class="footer-section">
      <h2 class="footer-logo">ElecTRON</h2>
      <p>Lo mejor en productos electr√≥nicos, componentes y tecnolog√≠a de punta.</p>
    </div>
    <div class="footer-section">
      <h3>Enlaces r√°pidos</h3>
      <ul>
        <li><a href="#">Inicio</a></li>
        <li><a href="#">Tienda</a></li>
        <li><a href="#">Ofertas</a></li>
        <li><a href="#">Contacto</a></li>
      </ul>
    </div>
    <div class="footer-section">
      <h3>Categor√≠as</h3>
      <ul>
        <li><a href="#">Componentes</a></li>
        <li><a href="#">Accesorios</a></li>
        <li><a href="#">Computadoras</a></li>
        <li><a href="#">Audio y Video</a></li>
      </ul>
    </div>
    <div class="footer-section">
      <h3>Cont√°ctanos</h3>
      <ul>
        <li>üìç Puerto Barrios, Izabal</li>
        <li>üìû +502 5986-1872</li>
        <li>‚úâÔ∏è contacto@electron.com</li>
      </ul>
      <div class="footer-social">
        <a href="#" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
        <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
        <a href="#" aria-label="X Twitter"><i class="fab fa-x-twitter"></i></a>
      </div>
    </div>
  <div class="footer-bottom">
    &copy; 2025 ElecTRON. Todos los derechos reservados.
  </div>
</footer>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
<script src="{% static 'productos/app.js' %}?v=1.2"></script>
</body>
</html>