<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Tienda de Electr√≥nica</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'productos/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/footer.css' %}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
</head>
<body>

<header>
    <div class="topbar">
        <div class="brand">
            <div class="badge">üíª</div>
            <div>ElecTRON</div>
        </div>
        <button id="themeToggle">‚òÄÔ∏è / üåô</button>
        <div class="spacer"></div>
        <button id="btnCart" class="pill eco">üõí Carrito <span id="cartCount" class="cart-count">0</span></button>
    </div>

    <form class="toolbar" method="get" action=".">
        <button type="submit" class="btn eco">Buscar</button>
        <div class="control">
            <input type="search" name="q" id="q" placeholder="Buscar (modelo, etiqueta, uso)" value="{{ request.GET.q }}">
        </div>
        <div class="control">
            <select name="type" id="type">
                <option value="">Categor√≠a</option>
                <option value="Computadora" {% if request.GET.type == "Computadora" %}selected{% endif %}>Computadora</option>
                <option value="Smartphone" {% if request.GET.type == "Smartphone" %}selected{% endif %}>Smartphone</option>
                <option value="Audifonos" {% if request.GET.type == "Audifonos" %}selected{% endif %}>Aud√≠fonos</option>
                <option value="TV" {% if request.GET.type == "TV" %}selected{% endif %}>TV</option>
                <option value="Consola" {% if request.GET.type == "Consola" %}selected{% endif %}>Consola</option>
                <option value="Accesorio" {% if request.GET.type == "Accesorio" %}selected{% endif %}>Accesorio</option>
                <option value="Microcontrolador" {% if request.GET.type == "Microcontrolador" %}selected{% endif %}>Microcontrolador</option>
            </select>

            <select name="brand" id="brand">
                <option value="">Marca</option>
                <option value="Apple" {% if request.GET.brand == "Apple" %}selected{% endif %}>Apple</option>
                <option value="Samsung" {% if request.GET.brand == "Samsung" %}selected{% endif %}>Samsung</option>
                <option value="Sony" {% if request.GET.brand == "Sony" %}selected{% endif %}>Sony</option>
                <option value="Logitech" {% if request.GET.brand == "Logitech" %}selected{% endif %}>Logitech</option>
                <option value="Xiaomi" {% if request.GET.brand == "Xiaomi" %}selected{% endif %}>Xiaomi</option>
                <option value="Arduino" {% if request.GET.brand == "Arduino" %}selected{% endif %}>Arduino</option>
            </select>
        </div>

        <div class="control">
            <input type="number" name="min" id="min" placeholder="Precio m√≠n (GTQ)" value="{{ request.GET.min }}">
            <input type="number" name="max" id="max" placeholder="Precio m√°x (GTQ)" value="{{ request.GET.max }}">
        </div>

        <div class="control">
            <select name="sort" id="sort">
                <option value="pop" {% if request.GET.sort == "pop" %}selected{% endif %}>Ordenar: Popularidad</option>
                <option value="priceAsc" {% if request.GET.sort == "priceAsc" %}selected{% endif %}>Precio ‚Üë</option>
                <option value="priceDesc" {% if request.GET.sort == "priceDesc" %}selected{% endif %}>Precio ‚Üì</option>
                <option value="rating" {% if request.GET.sort == "rating" %}selected{% endif %}>Mejor valoraci√≥n</option>
            </select>

            <div class="checks">
                <label class="small">
                    <input type="checkbox" name="nuevo" id="nuevo" {% if request.GET.nuevo %}checked{% endif %}> Nuevos
                </label>
                <label class="small">
                    <input type="checkbox" name="usado" id="usado" {% if request.GET.usado %}checked{% endif %}> Usados
                </label>
            </div>
        </div>

        <div class="control">
            <button type="submit" class="btn eco">Filtrar</button>
            <button type="button" id="limpiarF" class="pill">Eliminar filtrado</button>
        </div>
    </form>
</header>

<!-- Carrusel -->
<div class="container-fluid p-0">
    {% if carousel_images %}
    <div id="header-carousel" class="carousel slide" data-ride="carousel" data-interval="4000">
        <div class="carousel-inner">
            {% for img in carousel_images %}
            <div class="carousel-item {% if forloop.first %}active{% endif %}">
                {% if img.enlace %}
                    <a href="{{ img.enlace }}">
                        <img class="w-100" src="{{ img.imagen.url }}" alt="{{ img.titulo }}">
                    </a>
                {% else %}
                    <img class="w-100" src="{{ img.imagen.url }}" alt="{{ img.titulo }}">
                {% endif %}
                {% if img.titulo or img.descripcion %}
                <div class="carousel-caption d-flex flex-column align-items-center justify-content-center">
                    <div class="caption-glass" style="max-width:900px;">
                        {% if img.titulo %}<h4 class="text-white text-uppercase mb-md-2">{{ img.titulo }}</h4>{% endif %}
                        {% if img.descripcion %}<h1 class="display-4 text-white mb-md-3">{{ img.descripcion }}</h1>{% endif %}
                    </div>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        <a class="carousel-control-prev" href="#header-carousel" role="button" data-slide="prev">
            <div class="btn btn-dark" style="width:45px;height:45px;"><span class="carousel-control-prev-icon mb-n2"></span></div>
        </a>
        <a class="carousel-control-next" href="#header-carousel" role="button" data-slide="next">
            <div class="btn btn-dark" style="width:45px;height:45px;"><span class="carousel-control-next-icon mb-n2"></span></div>
        </a>
    </div>
    {% endif %}
</div>

<main>
    <div id="grid" class="grid">
        {% for p in productos %}
        <div class="card">
            <img class="thumb" src="{{ p.imagen.url }}" alt="{{ p.nombre }}">
            <div class="info">
                <div class="name">{{ p.nombre }}</div>
                <div class="desc">{{ p.descripcion }}</div>
                <div class="tag">{{ p.categoria }}</div>
                <div class="tag">{{ p.marca }}</div>
                <div class="tag">{{ p.estado|title }}</div>
                <div class="tags">
                    {% if p.tipo %}<span class="tag">{{ p.tipo }}</span>{% endif %}
                    {% if p.gama_alta %}<span class="tag">Gama Alta</span>{% endif %}
                    {% if p.portatil %}<span class="tag">Port√°til</span>{% endif %}
                    {% for t in p.tags %}{% if t %}<span class="tag">{{ t }}</span>{% endif %}{% endfor %}
                </div>
                <div class="row">
                    <div class="stars" title="{{ p.valoracion|floatformat:1 }} / 5">
                        {% for i in "12345" %}
                            {% if forloop.counter <= p.valoracion|floatformat:0 %}‚òÖ{% else %}‚òÜ{% endif %}
                        {% endfor %}
                    </div>
                    <div>
                        <span class="price">Q{{ p.precio }}</span>
                        {% if p.precio_original %}<span class="str">Q{{ p.precio_original }}</span>{% endif %}
                    </div>
                </div>
                <div class="actions">
                    <button class="btn eco" data-add="{{ p.id }}">A√±adir al carrito</button>
                </div>
            </div>
        </div>
        {% empty %}
        <p style="grid-column:1/-1; text-align:center">No hay productos.</p>
        {% endfor %}
    </div>
</main>

<aside id="drawer" class="drawer" aria-hidden="true"></aside>
<div id="overlay" class="overlay" role="dialog" aria-modal="true" aria-hidden="true"></div>
<footer class="footer"></footer>

<!-- Scripts JS -->
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
<script src="{% static 'productos/app.js' %}?v=1.2"></script>
</body>
</html>
